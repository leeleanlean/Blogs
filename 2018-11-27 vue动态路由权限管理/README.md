# vue 动态路由权限管理
根据不同的角色，展示不同的路由

### 实现思路

用户登录成后，把用户信息保存至localStorage 和 vuex，用addRutes动态添加用户路由。
然后用 localStorage 和 vuex相结合，解决用户刷新路由无效问题

```
***** 用户登录页面逻辑 *****
  ↓
  - 判断vuex中是否有用户信息
    ↓
    - 有用户信息
      ↓
      - 验证token
        ↓
        - 验证通过
          ↓
          - 自动跳转至首页
        ↓
        - 验证不通过
          ↓
          - 清空vuex中用户信息
          ↓
          - 跳转登录进行登录
            ↓
            - 登录失败
              ↓
              - 继续登录
            ↓
            - 登录成功
              ↓
              - 把用户信息保存至vuex
              - 把用户信息保存至localStorage
              - 用addRutes动态添加用户路由
              - 转至首页
    ↓
    - 没有用户信息
      ↓
      - 清空localStorage中的用户信息
      - 点击登录
        ↓
        - 登录失败
          ↓
          - 继续登录
        ↓
        - 登录成功
          ↓
          - 把用户信息保存至vuex
          - 把用户信息保存至localStorage
          - 用addRutes动态添加用户路由
          - 转至首页


***** 监听拦截路由变化逻辑 *****
  ↓
  - 判断vuex中是否有用户信息
    ↓
    - 有用户信息
      ↓
      - 验证token
        ↓
        - token验证通过
          ↓
          - 跳转路由
        ↓
        - token验证不通过
          ↓
          - 跳转登录页面
    ↓
    - 没有用户信息
      ↓
      - 判断localStorage中是否有用户信息
        ↓
        - 有用户信息
          ↓
          - 验证token
            ↓
            - token验证通过
              ↓
              - 获取localStorage用户信息
                ↓
                - 设置vuex中的用户信息
                ↓
                - 重新设置用户路由
            ↓
            - token验证不通过
              ↓
              - 跳转登录页面
        ↓
        - 没有用户信息
          ↓
          - 跳转登录
```

### 实现代码

vue-premission 目录